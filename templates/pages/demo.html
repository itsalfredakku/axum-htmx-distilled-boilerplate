{% extends "base.html" %}
{% block title %}Demo - Axum HTMX App{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="section-header mb-6">
        <h1 class="text-2xl"><i class="bi bi-lightning text-brand"></i> HTMX Demo</h1>
        <p>Interactive examples — all server-rendered, all HTMX-powered. No JS frameworks needed.</p>
    </div>

    <div class="row g-4">
        <!-- 1. Click to load -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-brand"><i class="bi bi-cursor-fill"></i></div>
                    <div>
                        <h5 class="mb-0">Click to Load</h5>
                        <span class="text-xs text-muted">hx-get &rarr; hx-target &rarr; hx-swap</span>
                    </div>
                </div>
                <p class="text-sm text-muted">Fetch an HTML fragment from the server and swap it into the page.</p>
                <button class="btn btn-primary btn-sm mb-3"
                        hx-get="/partials/item-list"
                        hx-target="#item-list-target"
                        hx-swap="innerHTML">
                    <i class="bi bi-download"></i> Load Items
                </button>
                <div id="item-list-target">
                    <p class="text-sm text-muted"><em>Click the button above&hellip;</em></p>
                </div>
            </div>
        </div>

        <!-- 2. Form submission -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-success"><i class="bi bi-input-cursor-text"></i></div>
                    <div>
                        <h5 class="mb-0">Form &rarr; Partial</h5>
                        <span class="text-xs text-muted">hx-get on &lt;form&gt; with query params</span>
                    </div>
                </div>
                <p class="text-sm text-muted">Submit a form — the response is a server-rendered HTML fragment.</p>
                <form hx-get="/partials/greeting" hx-target="#greeting-target" hx-swap="innerHTML" class="mb-3">
                    <div class="input-group input-group-sm">
                        <input type="text" name="name" class="form-control" placeholder="Your name">
                        <button class="btn btn-success" type="submit"><i class="bi bi-send"></i> Greet</button>
                    </div>
                </form>
                <div id="greeting-target"></div>
            </div>
        </div>

        <!-- 3. Polling -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-info"><i class="bi bi-arrow-repeat"></i></div>
                    <div>
                        <h5 class="mb-0">Live Polling</h5>
                        <span class="text-xs text-muted">hx-trigger="every 5s"</span>
                    </div>
                </div>
                <p class="text-sm text-muted">Auto-refreshing content — no WebSockets, just HTMX polling.</p>
                <div hx-get="/partials/status-card"
                     hx-trigger="every 5s"
                     hx-swap="innerHTML"
                     id="poll-demo">
                    <div class="row g-3">
                        <div class="col-md-4"><div class="skeleton skeleton-block"></div></div>
                        <div class="col-md-4"><div class="skeleton skeleton-block"></div></div>
                        <div class="col-md-4"><div class="skeleton skeleton-block"></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. Security info -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-success"><i class="bi bi-shield-check"></i></div>
                    <div>
                        <h5 class="mb-0">Security Active</h5>
                        <span class="text-xs text-muted">CSRF + CSP + SRI on every request</span>
                    </div>
                </div>
                <p class="text-sm text-muted">Inspect the network tab — every HTMX request includes the CSRF token automatically.</p>
                <ul class="text-sm line-height-relaxed" style="list-style:none;padding:0;">
                    <li><span class="badge-success badge">Active</span> CSRF token: rotating per-session</li>
                    <li><span class="badge-success badge">Active</span> CSP: strict, SRI-enforced</li>
                    <li><span class="badge-success badge">Active</span> Cookies: HttpOnly + SameSite=Strict</li>
                    <li><span class="badge-success badge">Active</span> No inline JS — all in auditable files</li>
                </ul>
            </div>
        </div>

        <!-- 5. Inline editing -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-warning"><i class="bi bi-pencil-square"></i></div>
                    <div>
                        <h5 class="mb-0">Inline Edit Pattern</h5>
                        <span class="text-xs text-muted">hx-swap="outerHTML" for in-place updates</span>
                    </div>
                </div>
                <p class="text-sm text-muted">Click edit to transform a view into an input — a common HTMX pattern.</p>
                <div id="inline-edit-demo">
                    <div class="d-flex align-items-center gap-2 p-3" style="background:var(--color-background-muted);border-radius:var(--radius-md);">
                        <span id="edit-value" class="text-sm fw-bold">Hello, World!</span>
                        <button class="btn btn-sm btn-outline-primary" onclick="document.getElementById('edit-form-demo').style.display='flex';this.parentElement.style.display='none';">
                            <i class="bi bi-pencil"></i> Edit
                        </button>
                    </div>
                    <div id="edit-form-demo" class="input-group input-group-sm" style="display:none;">
                        <input type="text" class="form-control" value="Hello, World!" id="edit-input-demo">
                        <button class="btn btn-primary" onclick="document.getElementById('edit-value').textContent=document.getElementById('edit-input-demo').value;document.getElementById('edit-form-demo').style.display='none';document.getElementById('edit-form-demo').previousElementSibling.style.display='flex';">
                            Save
                        </button>
                    </div>
                </div>
                <p class="text-xs text-muted mt-2">In a real app, the edit/save buttons would use <code>hx-get</code> and <code>hx-put</code> to fetch and submit server-rendered forms.</p>
            </div>
        </div>

        <!-- 6. Progress indicator -->
        <div class="col-md-6">
            <div class="card">
                <div class="d-flex align-items-center gap-2 mb-3">
                    <div class="icon-badge feature-icon-danger"><i class="bi bi-hourglass-split"></i></div>
                    <div>
                        <h5 class="mb-0">Loading Indicators</h5>
                        <span class="text-xs text-muted">htmx-indicator class</span>
                    </div>
                </div>
                <p class="text-sm text-muted">HTMX adds the <code>htmx-request</code> class during requests — use it for spinners.</p>
                <div>
                    <button class="btn btn-primary btn-sm"
                            hx-get="/partials/greeting?name=HTMX"
                            hx-target="#loading-demo-target"
                            hx-swap="innerHTML"
                            hx-indicator="#loading-spinner">
                        <i class="bi bi-arrow-clockwise"></i> Fetch with Indicator
                    </button>
                    <span id="loading-spinner" class="htmx-indicator text-sm text-muted ms-2">
                        <i class="bi bi-arrow-repeat"></i> Loading...
                    </span>
                </div>
                <div id="loading-demo-target" class="mt-2"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
